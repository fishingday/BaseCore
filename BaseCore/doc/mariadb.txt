alter table if exists cm_cd_dtl    drop    foreign key if exists FK_cm_cd_dtl;
alter table if exists cm_menu_dtl    drop    foreign key if exists FK_cm_menu_dtl;
alter table if exists cm_menu_dtl_role_map    drop    foreign key if exists FK_cm_menu_dtl_role_map1;
alter table if exists cm_menu_dtl_role_map    drop    foreign key if exists FK_cm_menu_dtl_role_map2;
alter table if exists cm_noti_user_map    drop    foreign key if exists FK_cm_noti_user_map1;   
alter table if exists cm_noti_user_map    drop    foreign key if exists FK_cm_noti_user_map2;   
alter table if exists cm_role_menu_map    drop    foreign key if exists FK_cm_role_menu_map1;   
alter table if exists cm_role_menu_map    drop    foreign key if exists FK_cm_role_menu_map2;
alter table if exists cm_user_alow_ip    drop    foreign key if exists FK_cm_user_alow_ip;
alter table if exists cm_user_pwd    drop    foreign key if exists FK_cm_user_pwd;
alter table if exists cm_user_role_map    drop    foreign key if exists FK_cm_user_role_map1;
alter table if exists cm_user_role_map    drop    foreign key if exists FK_cm_user_role_map2;
alter table if exists td_checker_map    drop    foreign key if exists FK_td_checker_map;
alter table if exists td_quiz_work_use    drop    foreign key if exists FK_td_quiz_work_use1;
alter table if exists td_quiz_work_use    drop    foreign key if exists FK_td_quiz_work_use2;
alter table if exists td_work    drop    foreign key if exists FK_td_work1;
alter table if exists td_work    drop    foreign key if exists FK_td_work2;
alter table if exists td_worker_map    drop    foreign key if exists FK_td_worker_map;
     
       
drop table if exists cm_cd_dtl;
drop table if exists cm_cd_grp;
drop table if exists cm_menu;
drop table if exists cm_menu_dtl;
drop table if exists cm_menu_dtl_role_map;
drop table if exists cm_noti;
drop table if exists cm_noti_user_map;
drop table if exists cm_role;
drop table if exists cm_role_chg_log;
drop table if exists cm_role_menu_map;
drop table if exists cm_user;
drop table if exists cm_user_alow_ip;
drop table if exists cm_user_pwd;
drop table if exists cm_user_relat;
drop table if exists cm_user_role_map;
drop table if exists td_checker_map;
drop table if exists td_quiz;
drop table if exists td_quiz_work_use;
drop table if exists td_setle;
drop table if exists td_todo;
drop table if exists td_work;
drop table if exists td_worker_map;
drop table if exists td_point;
    
create table cm_cd_dtl (
    prnt_ord integer not null,
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    cd_nm varchar(30) not null,
    cd varchar(35) not null,
    grp_cd varchar(35) not null,
    opt_1 varchar(256),
    opt_2 varchar(256),
    opt_3 varchar(256),
    opt_4 varchar(256),
    opt_5 varchar(256),
    cd_desc varchar(2000),
    del_yn VARCHAR(1) not null,
    primary key (cd, grp_cd)
) engine=InnoDB;

create table cm_cd_grp (
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    grp_cd_nm varchar(30) not null,
    grp_cd varchar(35) not null,
    grp_cd_desc varchar(2000),
    del_yn VARCHAR(1) not null,
    primary key (grp_cd)
) engine=InnoDB;

create table cm_menu (
    prnt_ord integer not null,
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    menu_seq bigint not null,
    up_menu_seq bigint,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    menu_nm varchar(30) not null,
    menu_desc varchar(2000),
    icon_info varchar(255),
    menu_path varchar(255),
    cm_scren_yn VARCHAR(1) not null,
    del_yn VARCHAR(1) not null,
    prnt_yn VARCHAR(1) not null,
    primary key (menu_seq)
) engine=InnoDB;

create table cm_menu_dtl (
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    menu_dtl_seq bigint not null,
    menu_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    menu_dtl_nm varchar(30) not null,
    menu_dtl_desc varchar(2000),
    menu_dtl_path varchar(255) not null,
    del_yn VARCHAR(1) not null,
    primary key (menu_dtl_seq)
) engine=InnoDB;

create table cm_menu_dtl_role_map (
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    menu_dtl_seq bigint not null,
    role_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    del_yn VARCHAR(1) not null,
    primary key (menu_dtl_seq, role_seq)
) engine=InnoDB;

create table cm_noti (
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    noti_end_dt datetime(6) not null,
    noti_send_dt datetime(6) not null,
    noti_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    noti_titl varchar(200) not null,
    noti_lnk_addr varchar(300),
    noti_cont varchar(2000) not null,
    del_yn VARCHAR(1) not null,
    noti_send_grd_cd enum ('INFO','IMPORTANT','EMERGENCY') not null,
    send_media_typ_cd enum ('EMAIL','NOTI','SMS') not null,
    send_yn VARCHAR(1) not null,
    primary key (noti_seq)
) engine=InnoDB;

create table cm_noti_user_map (
    view_cnt integer not null,
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    noti_seq bigint not null,
    noti_user_map_seq bigint not null,
    qry_dt datetime(6),
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    user_seq bigint not null,
    close_yn VARCHAR(1) not null,
    del_yn VARCHAR(1) not null,
    send_media_typ_cd enum ('EMAIL','NOTI','SMS') not null,
    primary key (noti_user_map_seq)
) engine=InnoDB;

create table cm_role (
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    role_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    role_nm varchar(30) not null,
    role_desc varchar(2000),
    def_page varchar(255),
    del_yn VARCHAR(1) not null,
    primary key (role_seq)
) engine=InnoDB;

create table cm_role_chg_log (
    excutor_seq bigint not null,
    role_chg_dt datetime(6) not null,
    role_chg_log_seq bigint not null,
    role_seq bigint not null,
    user_seq bigint not null,
    role_chg_cont varchar(2000) not null,
    role_chg_reason varchar(2000) not null,
    role_chg_cd enum ('ADD','REMOVE','UPDATE') not null,
    primary key (role_chg_log_seq)
) engine=InnoDB;

create table cm_role_menu_map (
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    menu_seq bigint not null,
    role_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    del_yn VARCHAR(1) not null,
    primary key (menu_seq, role_seq)
) engine=InnoDB;

create table cm_user (
    acunt_exp_dt date not null,
    login_fail_cnt integer not null,
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    login_dt datetime(6),
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    user_seq bigint not null,
    user_tel_no varchar(20),
    last_login_ip varchar(23),
    user_nm varchar(30) not null,
    login_id varchar(255) not null,
    del_yn VARCHAR(1) not null,
    user_stat_cd enum ('ENABLED','LOCKED','DISABLED') not null,
    primary key (user_seq)
) engine=InnoDB;

create table cm_user_alow_ip (
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    user_alow_ip_seq bigint not null,
    user_seq bigint not null,
    alow_ip varchar(30) not null,
    alow_ip_desc varchar(2000),
    del_yn VARCHAR(1) not null,
    primary key (user_alow_ip_seq)
) engine=InnoDB;

create table cm_user_pwd (
    pwd_exp_dt date,
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    user_pwd_seq bigint not null,
    user_seq bigint not null,
    user_pwd varchar(256) not null,
    del_yn VARCHAR(1) not null,
    primary key (user_pwd_seq)
) engine=InnoDB;

create table cm_user_relat (
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    relat_aply_dt datetime(6),
    relator_seq bigint not null,
    targeter_agre_dt datetime(6),
    targeter_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    user_relat_dtl_val varchar(20) not null,
    relator_calnm varchar(30),
    targeter_calnm varchar(30),
    del_yn VARCHAR(1) not null,
    targeter_agre_yn VARCHAR(1) not null,
    user_relat_cd enum ('GRAND','PARENT','RELAT','CHILD','SELF') not null,
    primary key (relator_seq, targeter_seq)
) engine=InnoDB;

create table cm_user_role_map (
    prnt_ord integer not null,
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    role_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    user_seq bigint not null,
    del_yn VARCHAR(1) not null,
    primary key (role_seq, user_seq)
) engine=InnoDB;

create table td_checker_map (
    checker_seq bigint not null,
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    todo_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    del_yn VARCHAR(1) not null,
    primary key (checker_seq, todo_seq)
) engine=InnoDB;

create table td_quiz (
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    quiz_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    quiz_answer varchar(128) not null,
    quiz_titl varchar(200) not null,
    quiz_cont varchar(2000) not null,
    del_yn VARCHAR(1) not null,
    quiz_typ_cd enum ('ENG_WORD','ENG_IDOIOM','ENG_SENTENCE','MATH') not null,
    primary key (quiz_seq)
) engine=InnoDB;

create table td_quiz_work_use (
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    quiz_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    user_seq bigint not null,
    work_seq bigint not null,
    del_yn VARCHAR(1) not null,
    primary key (quiz_seq, work_seq)
) engine=InnoDB;

create table td_setle (
    accumult_point integer not null,
    total_setle_point integer not null,
    acount_seq bigint not null,
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    setle_dt datetime(6),
    setle_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    worker_seq bigint not null,
    setle_desc varchar(255),
    del_yn VARCHAR(1) not null,
    primary key (setle_seq)
) engine=InnoDB;

create table td_todo (
    aplyto_ord integer,
    date_limit_cnt integer not null,
    limit_begin_tm time(6),
    limit_end_tm time(6),
    post_begin_date date not null,
    post_end_date date not null,
    todo_point integer not null,
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    todo_seq bigint not null,
    up_todo_seq bigint,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    confm_dtl_val varchar(20),
    complet_condi_val varchar(128) not null,
    todo_cre_dtl_val varchar(128),
    todo_titl varchar(200) not null,
    todo_desc varchar(2000),
    todo_tmp_cont varchar(2000) not null,
    confm_meth_cd enum ('SCORE','ENG_CNT','WORD_CNT','INTIME','EYE_CHECK','CHECKER') not null,
    del_yn VARCHAR(1) not null,
    quiz_typ_cd enum ('ENG_WORD','ENG_IDOIOM','ENG_SENTENCE','MATH'),
    quiz_use_yn VARCHAR(1) not null,
    todo_cre_cd enum ('DAILY','WEEK','MONTH','DIRECT') not null,
    todo_typ_cd enum ('WAKEUP','SLEEP','CLEAN','DIARY','EXERCISE','READING','EXAM','ETIQUET','PRESENT') not null,
    primary key (todo_seq)
) engine=InnoDB;

create table td_work (
    gain_point integer,
    checker_seq bigint,
    confm_dt datetime(6),
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    file_grp_seq bigint,
    setle_seq bigint,
    todo_seq bigint not null,
    up_work_seq bigint,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    work_begin_dt datetime(6),
    work_dt datetime(6),
    work_end_dt datetime(6),
    work_poss_begin_dt datetime(6) not null,
    work_poss_end_dt datetime(6) not null,
    work_seq bigint not null,
    worker_seq bigint not null,
    work_titl varchar(200),
    confm_cont varchar(2000),
    work_cont varchar(4000),
    work_rslt_val varchar(4000),
    del_yn VARCHAR(1) not null,
    setle_yn VARCHAR(1) not null,
    work_stat_cd enum ('READY','ONGOING','LACK','FAIL','DONE') not null,
    primary key (work_seq)
) engine=InnoDB;

create table td_worker_map (
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    todo_seq bigint not null,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    worker_seq bigint not null,
    del_yn VARCHAR(1) not null,
    worker_agre_yn VARCHAR(1) not null,
    primary key (todo_seq, worker_seq)
) engine=InnoDB;

create table td_point (
    aplyto_point integer not null,
    last_point integer not null,
    cre_dt datetime(6) not null,
    creator_seq bigint not null,
    point_seq bigint not null,
    setle_seq bigint,
    upd_dt datetime(6) not null,
    updator_seq bigint not null,
    user_seq bigint not null,
    point_cont varchar(2000),
    del_yn VARCHAR(1) not null,
    point_aplyto_cd enum ('USE','ADD') not null,
    primary key (point_seq)
) engine=InnoDB;


alter table if exists cm_user 
   add constraint UK_cm_user unique (login_id);
   
alter table if exists cm_cd_dtl 
   add constraint FK_cm_cd_dtl
   foreign key (grp_cd) 
   references cm_cd_grp (grp_cd);
   
alter table if exists cm_menu_dtl 
   add constraint FK_cm_menu_dtl
   foreign key (menu_seq) 
   references cm_menu (menu_seq);
   
alter table if exists cm_menu_dtl_role_map 
   add constraint FK_cm_menu_dtl_role_map1
   foreign key (menu_dtl_seq) 
   references cm_menu_dtl (menu_dtl_seq);
   
alter table if exists cm_menu_dtl_role_map 
   add constraint FK_cm_menu_dtl_role_map2
   foreign key (role_seq) 
   references cm_role (role_seq);
   
alter table if exists cm_noti_user_map 
   add constraint FK_cm_noti_user_map1
   foreign key (noti_seq) 
   references cm_noti (noti_seq);
   
alter table if exists cm_noti_user_map 
   add constraint FK_cm_noti_user_map2
   foreign key (user_seq) 
   references cm_user (user_seq);
   
alter table if exists cm_role_menu_map 
   add constraint FK_cm_role_menu_map1
   foreign key (menu_seq) 
   references cm_menu (menu_seq);
   
alter table if exists cm_role_menu_map
   add constraint FK_cm_role_menu_map2
   foreign key (role_seq) 
   references cm_role (role_seq);
   
alter table if exists cm_user_alow_ip 
   add constraint FK_cm_user_alow_ip
   foreign key (user_seq) 
   references cm_user (user_seq);
   
alter table if exists cm_user_pwd 
   add constraint FK_cm_user_pwd
   foreign key (user_seq) 
   references cm_user (user_seq);
   
alter table if exists cm_user_role_map 
   add constraint FK_cm_user_role_map1
   foreign key (role_seq) 
   references cm_role (role_seq);
   
alter table if exists cm_user_role_map 
   add constraint FK_cm_user_role_map2
   foreign key (user_seq) 
   references cm_user (user_seq);
   
alter table if exists td_checker_map 
   add constraint FK_td_checker_map
   foreign key (todo_seq) 
   references td_todo (todo_seq);
   
alter table if exists td_quiz_work_use
   add constraint FK_td_quiz_work_use1
   foreign key (quiz_seq) 
   references td_quiz (quiz_seq);
   
alter table if exists td_quiz_work_use 
   add constraint FK_td_quiz_work_use2
   foreign key (work_seq) 
   references td_work (work_seq);
   
alter table if exists td_work 
   add constraint FK_td_work1
   foreign key (setle_seq) 
   references td_setle (setle_seq);
   
alter table if exists td_work 
   add constraint FK_td_work2
   foreign key (todo_seq) 
   references td_todo (todo_seq);
   
alter table if exists td_worker_map 
   add constraint FK_td_worker_map
   foreign key (todo_seq) 
   references td_todo (todo_seq);