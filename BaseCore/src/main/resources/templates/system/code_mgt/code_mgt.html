<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/default_layout}">
	<head>
	  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	  <title>코드관리</title>
    <style>
      /* 사용자 정의 css */
      a:hover {
		     cursor: pointer;
	    }
	    tr>td:hover{
			  cursor: pointer;
		  }
    </style>
	</head>
	<body>
	<!-- Content 시작 -->
	    <div layout:fragment="content" class="col">
	    	<div class="row">
				<div class="col-5">
					<div id="toolbar-grpcd">
						<button id="btnAddGrpCd" class="btn btn-danger chg-btn">
						  <i class="bi bi-plus-square-fill"></i> 신규
						</button>
					</div>
					<table
					  id="table-grpcd"
					  data-toolbar="#toolbar-grpcd"
					  data-search="true"
					  data-click-to-select="true"
					  data-id-field="grpCd"
					  th:data-url="@{/system/code_mgt/get_grpcd_list.json}">
					</table>
				</div>
				<div class="col-7">
					<div class="row" id="child-box">
						<ul class="nav nav-tabs">
						  <li class="nav-item">
						    <a class="nav-link" id="tabCodeList">코드목록</a>
						  </li>
						  <li class="nav-item">
						    <a class="nav-link" id="tabGrpCdInfo" >그룹코드정보</a>
						  </li>
						  <li class="nav-item">
						    <a class="nav-link" id="tabCodeGen">Gen Code</a>
						  </li>
						</ul>
					</div>
					<div class="row border border-top-0 border-secondary-subtle" style="height: 558px;">
						<div id="tabCodeListDiv">						
							<div id="toolbar-dtlcd">
								<button id="btnAddGrpCd" class="btn btn-danger chg-btn">
								  <i class="bi bi-plus-square-fill"></i> 신규
								</button>
							</div>
							<table
							  id="table-dtlcd"
							  data-toolbar="#toolbar-dtlcd"
							  data-search="true"
							  data-click-to-select="true"
							  data-id-field="grpCd"
							  th:data-url="@{/system/code_mgt/get_code_list.json}">
							</table>
						</div>
						<div id="tabGrpCdInfoDiv">
							<h4 class="mb-3 mt-5">그룹 코드 정보</h4>
							<div class="mb-3 row">
                <label for="grpCd" class="col-sm-4 col-form-label text-bg-light">그룹 코드</label>
                <div class="col-sm-8">
                  <input type="text" readonly class="form-control-plaintext" id="grpCd" required>
                </div>
              </div>
							<div class="mb-3 row">
                <label for="grpCdNm" class="col-sm-4 col-form-label text-bg-light">그룹 코드 명</label>
                <div class="col-sm-8">
                  <input type="text" class="form-control" id="grpCdNm" required>
                </div>
              </div>
							<div class="mb-3 row">
                <label for="grpCdDesc" class="col-sm-4 col-form-label text-bg-light">그룹 코드 설명</label>
                <div class="col-sm-8">
                   <textarea class="form-control" id="grpCdDesc" rows="3"></textarea>
                </div>
              </div>
              <div class="mb-3 row ">
								<div class="col-auto me-auto">
                  <button type="button" class="btn btn-outline-danger" id="btnDeleteGrpCd">삭제</button>
								</div>
								<div class="col-auto">
								  <button type="button" class="btn btn-outline-success" id="btnSaveGrpCd">저장</button>
								</div>
			        </div>            
						</div>
						<div id="tabCodeGenDiv">
							
						</div>
					</div>
				</div>
			</div>
	    </div>
	    <script language="javascript" type="text/javascript" layout:fragment="page_script">
			var $table_grpcd = $('#table-grpcd');
			var $table_dtlcd = $('#table-dtlcd');
			
			var fnObj = {
				pageStart:  function(){ // 페이지 초기 실행 스크립트
          fnObj.page.init();
          fnObj.grid.init();
				},
				page: {
					init: function(){ // 버튼 바인딩 등 
						$("#btnAddGrpCd").bind("click", function(){ // 조회 
              console.log("add-btn");
            });
            
            $("#tabCodeList").bind("click", function(){ // 패스워드 저장
              
              $("#tabCodeList").addClass("active");
              $("#tabCodeList").prop("aria-current", "page");
              $("#tabCodeListDiv").show();
              
              $("#tabGrpCdInfo").removeClass("active");
              $("#tabGrpCdInfo").removeAttr("aria-current");
              $("#tabGrpCdInfoDiv").hide();
              
              $("#tabCodeGen").removeClass("active");
              $("#tabCodeGen").removeAttr("aria-current");
              $("#tabCodeGenDiv").hide();
              
            });
            
            $("#tabGrpCdInfo").bind("click", function(){ // 조회 
              
              $("#tabCodeList").removeClass("active");              
              $("#tabCodeList").removeAttr("aria-current");
              $("#tabCodeListDiv").hide();
              
              $("#tabGrpCdInfo").addClass("active");
              $("#tabGrpCdInfo").prop("aria-current", "page");
              $("#tabGrpCdInfoDiv").show();
              
              $("#tabCodeGen").removeClass("active");              
              $("#tabCodeGen").removeAttr("aria-current");
              $("#tabCodeGenDiv").hide();
              
            });
            
            $("#tabCodeGen").bind("click", function(){ // 역할 저장 
              
              $("#tabCodeList").removeClass("active");
              $("#tabCodeList").removeAttr("aria-current");
              $("#tabCodeListDiv").hide();
              
              $("#tabGrpCdInfo").removeClass("active");
              $("#tabGrpCdInfo").removeAttr("aria-current");
              $("#tabGrpCdInfoDiv").hide();
              
              $("#tabCodeGen").addClass("active");
              $("#tabCodeGen").prop("aria-current", "page");
              $("#tabCodeGenDiv").show();
            });
						
					}					
				},
				action: { // 호출이나 화면 동작
				  chooseGrpCd : function(grpInfo){
					  $("#grpCd").val(grpInfo.grpCd);
					  $("#grpCdNm").val(grpInfo.grpCdNm);
					  $("#grpCdDesc").val(grpInfo.grpCdDesc);
				  }	
				},
				grid: { // 그리드 관련
					init : function() {
					    $table_grpcd.bootstrapTable('destroy').bootstrapTable({
						    height: 600,
					      locale: 'ko-KR',
					      classes: 'table table-bordered table-hover',
					      headerStyle : function(){
							    return {classes: 'table-primary'};
						    },
					      columns: [
					        [
					          {field: 'radio',     radio: true, class: 'table-primary', formatter:function(value, row, index){
                          if(index === 0){
							              $("#tabCodeList").click();
							              fnObj.action.chooseGrpCd(row);
                            return {checked: true}
                          }
                        }},
					          {field: 'grpCd',     title: '그룹코드',    align: 'center', valign: 'middle', sortable: true}, 
					          {field: 'grpCdNm',   title: '그룸명',   align: 'center', valign: 'middle', sortable: true}
					        ]
					      ]
					    });
					    
					    $table_grpcd.on('check.bs.table', function (e, row) {
					      fnObj.action.chooseGrpCd(row);
					    });
					    
					    $table_dtlcd.bootstrapTable('destroy').bootstrapTable({
                locale: 'ko-KR',
                classes: 'table table-bordered table-striped table-hover',
                headerStyle : function(){
                  return {classes: 'table-primary'};
                },
                columns: 
                  [
                    [
                      {field: 'grpCd',      title: '그룹코드',	align: 'center', valign: 'middle', visible: false, switchable: false},       
                      {field: 'cd',         title: '코드',		align: 'center', valign: 'middle', sortable: true},  
                      {field: 'CdNm',       title: '코드명',	align: 'center', valign: 'middle', sortable: true}, 
                      {field: 'cdDesc',     title: '설명',		align: 'center', valign: 'middle', visible: false, sortable: false}, 
                      {field: 'opt1',       title: '옵션1',		align: 'center', valign: 'middle', visible: false, sortable: false},                   
                      {field: 'opt2',       title: '옵션2',		align: 'center', valign: 'middle', visible: false, sortable: false},  
                      {field: 'opt3',       title: '옵션3',		align: 'center', valign: 'middle', visible: false, sortable: false},                   
                      {field: 'opt4',       title: '옵션4',		align: 'center', valign: 'middle', visible: false, sortable: false},                   
                      {field: 'opt5',       title: '옵션5',		align: 'center', valign: 'middle', visible: false, sortable: false},
                      {field: 'prntOrd',    title: '순서',		align: 'center', valign: 'middle', sortable: true},
                      {field: 'operate',      title: '상세보기',   align: 'center', valign: 'middle', clickToSelect: false, events: window.operateEvents,
                        formatter: function(value, row, index) {
                          return [
                              '<a class="userinfo-edit" href="javascript:void(0)" title="사용자정보" data-bs-toggle="modal" data-bs-target="#popupUserInfo" >',
                              '<i class="bi bi-pencil-square"></i>',
                              '</a>'
                            ].join('')
                        }
                      }
                    ]
                  ],
                queryParams: function(params){
                  params.grpCd = $("#grpCd").val();                  
                  return params;
                }
            });
					}
					
				}
			}
			
			// 페이지 초기 쿼리를 실행한다.
	        $(document.body).ready(function () {
	            fnObj.pageStart();
	        });
		</script>
	<!-- Content 종료 -->
	</body>
</html>