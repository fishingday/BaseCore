<html lagn="ko"
    xmlns:th="http://www.thymeleaf.org"
    xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

    <div th:fragment="headerFragment">
        <script th:src="@{/webjars/jquery/3.6.4/jquery.min.js}"></script>
        <script th:src="@{/webjars/jquery-ui/1.13.2/jquery-ui.js}"></script>
        <script th:src="@{/webjars/font-awesome/6.4.0/js/all.min.js}"></script>
        <script th:src="@{/webjars/bootstrap/5.3.0/js/bootstrap.bundle.min.js}"></script>
        <script th:src="@{/webjars/jquery-i18n-properties/1.10.2/jquery.i18n.properties.min.js}"></script>
        <script th:src="@{/webjars/sweetalert2/11.7.12/dist/sweetalert2.all.min.js}"></script>
        <link rel="stylesheet" th:href="@{/css/base.css}" />
        <link rel="stylesheet" th:href="@{/webjars/jquery-ui/1.13.2/jquery-ui.css}" />
        <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.3.0/css/bootstrap.min.css}" />
        <link rel="stylesheet" th:href="@{/webjars/font-awesome/6.4.0/css/all.min.css}" />
    </div>

    <div th:fragment="topFragment">
	  <!-- header -->
	  <!-- header #1 -->
	  <nav class="py-2 bg-body-tertiary">
	    <div class="container d-flex flex-wrap">
	      <ul class="nav me-auto">
	      <th:block sec:authorize="isAuthenticated()" th:each="topMenu : ${#authentication.principal.myMenu.topMenuList}">
			<li class="nav-item" th:if="${topMenuStat.index eq 0}"><a href="#" class="nav-link link-body-emphasis px-2" aria-current="page">Home</a></li>
            <li class="nav-item"><a class="nav-link link-body-emphasis px-2" th:href="@{${topMenu.firstMenu.menuPath}}"><span th:text="${topMenu.menuNm}"></span></a></li>
          </th:block>
	      </ul>
	      <ul class="nav">
	        <li class="nav-item" sec:authorize="isAnonymous()"><a class="nav-link link-body-emphasis px-2" th:href="@{/common/login.html}">로그인</a></li>
            <li class="nav-item" sec:authorize="isAnonymous()"><a class="nav-link link-body-emphasis px-2" th:href="@{/users}">회원가입</a></li>
            <li class="nav-item" sec:authorize="isAuthenticated()">
				<span sec:authorize="isAuthenticated()" th:text="|로그인시간 : ${#temporals.format(#authentication.principal.cmUser.loginDt, 'yyyy.MM.dd HH:mm:ss')}|"></span>
			</li>
	      </ul>
	    </div>
	  </nav>			  
	  <!-- header #1 -->			  
	  <!-- header #2 -->
	  <header class="pb-2 mb-3 border-bottom">
	    <div class="container" sec:authorize="isAuthenticated()" th:with="auth=${#authentication.principal}">
		  <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-end">
	        <div class="dropdown text-start" style="width: 100px;">
	          <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
			    [[${auth.currRole.roleNm}]]
			  </button>
	          <ul class="dropdown-menu text-small">
                <li th:each="roleItem: ${auth.authRoleList}"><a class="dropdown-item" href="#">[[${roleItem.roleNm}]]</a></li>
              </ul>
	        </div>
	        <div class="dropdown text-end">			          
	          <ul class="dropdown-menu text-small">
	            <li><a class="dropdown-item" href="#">New project...</a></li>
	            <li><a class="dropdown-item" href="#">Settings</a></li>
	            <li><a class="dropdown-item" href="#">Profile</a></li>
	            <li><hr class="dropdown-divider"></li>
	            <li><a class="dropdown-item" th:href="@{/common/logout.html}">Sign out</a></li>
	          </ul>
	          <a href="#" class="d-block link-body-emphasis text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
	            <i class="fa-regular fa-circle-user fa-2xl"></i>
	            <span>[[${auth.cmUser.userNm}]]</span>
	          </a>
	        </div>
	      </div>
	    </div>
	  </header>
	  <!-- header #2 -->
	  <!-- header -->
    </div>
    

  <div class="flex-shrink-0 p-3" style="width: 280px;" th:fragment="lnbFragment"  th:with="currMenu=${#authentication.principal.currMenu}">
    <a href="/" class="d-flex align-items-center pb-3 mb-3 link-body-emphasis text-decoration-none border-bottom">
      <i class="fa-brands fa-hashnode  fa-xl"></i>
      <span class="fs-5 fw-semibold"> [[${currMenu.topMenu.menuNm}]]</span>
    </a>
    <ul class="list-unstyled ps-0" th:with="topMenu=${#authentication.principal.currMenu.topMenu}"><!--/* 현재 메뉴의 상위 메뉴를  */-->
      <li class="mb-1" th:each="subMenu : ${topMenu.subMenuList}">
        <button class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-toggle="collapse" data-bs-target="#home-collapse" 
        	th:if="${subMenu.menuSeq == currMenu.menuSeq ? 'aria-expanded=true' : 'text-primary'}" th:aria-expanded="${subMenu.menuSeq == currMenu.menuSeq or subMenu.menuSeq == currMenu.upMenu.menuSeq}">
          [[${subMenu.menuNm}]]
        </button>
        <div class="collapse show" id="home-collapse" th:if="${#lists.size(subMenu.subMenuList) > 0}"></div>
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            <li th:if="${#lists.size(subMenu.subMenuList) > 0}" th:each="leafMenu : ${subMenu.subMenuList}">
				<a th:href="@{${leafMenu.menuPath}}" class="link-body-emphasis d-inline-flex text-decoration-none rounded" th:classappend="${leafMenu.menuSeq == currMenu.menuSeq} ? 'fw-bold':''"
					>[[${subMenu.menuNm}]]/[[${leafMenu.menuNm}]]</a>
            </li>
          </ul>
        </div>
      </li>
      <li class="border-top my-3"></li>
    </ul>
  </div>

    <nav th:fragment="lnbFragment2" class="col-md-2 d-none d-md-block bg-light sidebar" th:with="currMenu=${#authentication.principal.currMenu}">
        <div class="sidebar-sticky">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <div style="padding-top:10px;" class="nav flex-column nav-pills" aria-orientation="vertical">
                        <th:block th:with="topMenu=${#authentication.principal.currMenu.topMenu}"><!--/* 현재 메뉴의 상위 메뉴를  */-->
                            <th:block th:each="subMenu : ${topMenu.subMenuList}"><!--/* 현재 메뉴의 상위 메뉴를  */-->
                                <a th:href="@{${subMenu.menuPath}}" style="margin:5px;"
                                   th:class="'nav-link  '+${subMenu.menuSeq == currMenu.menuSeq ? 'active' : 'text-primary'}">[[${subMenu.menuNm}]]</a>
                                <th:block th:if="${#lists.size(subMenu.subMenuList) > 0}" th:each="leafMenu : ${subMenu.subMenuList}">
                                    <a th:href="@{${leafMenu.menuPath}}" style="margin:5px;"
                                       th:class="'nav-link  '+${leafMenu.menuSeq == currMenu.menuSeq ? 'active' : 'text-primary'}" >[[${subMenu.menuNm}]]/[[${leafMenu.menuNm}]]</a>
                                </th:block>
                            </th:block>
                        </th:block>
                    </div>
                </li>
            </ul>
        </div>
    </nav>
	<footer class="py-3 my-4" th:fragment="footerFragment">
		<ul class="nav justify-content-center border-bottom pb-3 mb-3">
			<li class="nav-item"><a href="#" class="nav-link px-2 text-body-secondary">Home</a></li>
			<li class="nav-item"><a href="#" class="nav-link px-2 text-body-secondary">Features</a></li>
			<li class="nav-item"><a href="#" class="nav-link px-2 text-body-secondary">Pricing</a></li>
			<li class="nav-item"><a href="#" class="nav-link px-2 text-body-secondary">FAQs</a></li>
			<li class="nav-item"><a href="#" class="nav-link px-2 text-body-secondary">About</a></li>
		</ul>
		<p class="text-center text-body-secondary">&copy; 2023 Company, Inc</p>
	</footer>

</html>